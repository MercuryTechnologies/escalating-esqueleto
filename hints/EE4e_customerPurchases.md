First, read the error carefully.

Note that this is an unfortunate case of compile-time-valid esqueleto producing a runtime error!

Decide what you think this query is trying to do. The name isn't very clear, and the type leaves open a few possible interpretations.
